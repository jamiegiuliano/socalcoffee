---
layout: default
hero: lg
---

<section id="page_hero" class="hero hero-sm">
  <div class="wrapper">
    <div class="hero-inner">
      <h1 id="shop_name" class="text-white bold xs-pb0">{{ page.shop_name }}</h1>
      <span id="is_open_now_hero" class="open-now open-now-hero"></span>
    </div>
  </div>
  <span id="hero_image" class="img" style="background-image:url(/uploads/{{page.slug}}.jpg);"></span>
</section>

<section class="xs-inline-block">
  <div class="wrapper">
    <div class="sm-col-9 col">
      <h2 class="bold text-primary xs-pb4 md-pb0">
        {% include chunks/shop-description.html %}
      </h2>
    </div>
  </div>
</section>

<section class="xs-inline-block">
  <div class="wrapper">

    <div class="xs-col-12 sm-col-6 col xs-mb3 md-mb0">
      <div id='map' class="shop"></div>
    </div>
    <div id="info_block" class="xs-col-12 sm-col-5 sm-offset-1 col xs-relative">
      <span>
        <h4 class="text-secondary bold xs-pb3">Location & Contact</h4>
        <h3 class="bold wrap text-primary"><a id="address" class="text-secondary underline" href="http://maps.google.com/?q={{page.address}}">{{page.address}}</a></h3>
        <h3 class="bold wrap text-primary underline"><a id="phone" href="tel:{{page.phone}}" class="text-secondary">{{page.phone}}</a></h3>
        <h4 class="text-secondary bold xs-pt3 xs-pb3">Hours <span id="is_open_now" class="open-now open-now-mini"></span></h4>
        {% if page.yelp_id %}
          <table>
            <thead>
              <tr>
                <th>Days</th>
                <th>Time</th>
              </tr>
            </thead>
            <tbody id="open_hours"></tbody>
          </table>
        {% else %}
          {{ page.hours | markdownify }}
        {% endif %}
      </span>
    </div>
  </div>
</section>

<script type="text/javascript">

  {% if page.yelp_id %}
    loadingHandler("info_block", "data-loading", "pending")
    loadingHandler("is_open_now_hero", "data-loading", "pending")

    fetch("https://cors-anywhere.herokuapp.com/https://api.yelp.com/v3/businesses/{{ page.yelp_id }}", {
      headers: myHeaders
    }).then((resp) => {
      return resp.json();
    }).then((data) => {
      console.log(data);
      loadingHandler("info_block", "data-loading", "success")
      loadingHandler("is_open_now_hero", "data-loading", "success")

      const closed_forever = passBool(data.is_closed)
      const openHoursEl = document.getElementById("open_hours")

      if (!closed_forever) {
        const openHours = data.hours ? data.hours[0].open : []
        const openNow = document.getElementById("is_open_now")
        const openNowHero = document.getElementById("is_open_now_hero")
        const pageHero = document.getElementById("page_hero")

        const openHourArr = openHours.map(item => {
          let start = formatTime(item.start)
          let end = formatTime(item.end)
          let hours = `${start}â€“${end}`
          let day = item.day === 0 ? 'Monday' : item.day === 1 ? 'Tuesday' : item.day === 2 ? 'Wednesday' : item.day === 3 ? 'Thursday' : item.day === 4 ? 'Friday' : item.day === 5 ? 'Saturday' : item.day === 6 ? 'Sunday' : ''
          let object = `<tr><td>${day}</td><td>${hours}</td></tr>`
          return object
        })
        const openHourList = openHourArr.join("")
        openHoursEl.innerHTML = openHourList
        let isOpenNowStr = ""
        const isOpenNow = data.hours ? data.hours[0].is_open_now : false

        if (data.hours) {
          isOpenNowStr = isOpenNow ? "Open Now!" : "Not Open"
        } else {
          isOpenNowStr = "Hours Unavailable"
        }

        openNow.innerHTML = isOpenNowStr
        openNow.setAttribute('data-open', isOpenNow)
        openNowHero.innerHTML = isOpenNowStr
        openNowHero.setAttribute('data-open', isOpenNow)

      } else if (closed_forever) {
        console.log("Closed: " + data.is_closed);
        const isOpenNowStr = "Closed Permenantly"

        openNow.innerHTML = isOpenNowStr
        openNow.setAttribute('data-open', 'closed_forever')
        openNowHero.innerHTML = isOpenNowStr
        openNowHero.setAttribute('data-open', 'closed_forever')
        pageHero.style.background = "rgba(255,0,0,.65)"
      }

      const addressEl = document.getElementById("address")
      const phoneEl = document.getElementById("phone")

      const address1 = passString(data.location.address1)
      const address2 = passString(data.location.address2)
      const address3 = passString(data.location.address3)
      const city = passString(data.location.city)
      const state = passString(data.location.state)
      const zip_code = passString(data.location.zip_code)
      const phone = passString(data.phone)

      const addressConcat = `${address1} ${address2} ${address3}\r${city}, ${state} ${zip_code}`
      addressEl.innerHTML = addressConcat
      addressEl.href = `http://maps.google.com/?q=${addressConcat}`

      phoneEl.innerHTML = formatPhoneNumber(phone)
      phoneEl.href = `tel:${phone}`

      const heroImage = '/uploads/{{page.slug}}.jpg'
      const yelpImage = passString(data.image_url)
      const heroImageExists = imageExists(heroImage, function(exists) {
        console.log("Has Image: " + exists);
        if (!exists) {
          imageExists(yelpImage, function(exists) {
            if (exists) {
              const imageEl = document.getElementById("hero_image")
              imageEl.style.backgroundImage = `url(${yelpImage})`;
            }
          });
        }
      });

    }).catch((error) => {
      console.log("Shit fucked up! => " + error)
      loadingHandler("info_block", "data-loading", "failed")
      loadingHandler("is_open_now_hero", "data-loading", "failed")
    });

  {% endif %}

</script>

{% include scripts/shop-map-js.html %}
